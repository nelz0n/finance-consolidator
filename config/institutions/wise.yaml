# Wise (formerly TransferWise) Configuration
# Handles transaction history CSV exports from Wise

institution:
  name: "Wise"
  type: "payment_service"
  country: "Multi"

file_detection:
  filename_patterns:
    - "transaction-history.csv"
    - "wise_*.csv"
    - "transferwise_*.csv"

csv_format:
  encoding: "utf-8"
  delimiter: ","
  has_header: true
  skip_rows: 0

transformations:
  # Date format
  date:
    format: "%Y-%m-%d %H:%M:%S"

  # Amount format
  amount:
    decimal_separator: "."
    thousands_separator: ""
    reverse_sign: false

  # Combine description + reference + note
  combined_description: "'Target name' + ' [Ref: ' + 'Reference' + '] [Note: ' + 'Note' + ']'"

column_mapping:
  # Core fields
  date: "Finished on"
  description: "combined_description"
  amount: "Source amount (after fees)"
  currency: "Source currency"

  # Counterparty (conditional based on Direction)
  counterparty_name: "Target name"   # Default: for OUT transfers
  _source_name: "Source name"        # For IN transfers (used in normalizer)

  # Optional fields
  transaction_id: "ID"
  category: "Category"

  # Internal fields for processing
  _direction: "Direction"
  _status: "Status"

filtering:
  # Only process COMPLETED transactions
  status_include:
    - "COMPLETED"

  # Skip cancelled and refunded
  status_exclude:
    - "CANCELLED"
    - "REFUNDED"

owner_detection:
  method: "fixed"
  default_owner: "Branislav"

category_mapping:
  "Transport": "Transport"
  "Bills": "Bills"
  "Eating out": "Dining"
  "Groceries": "Groceries"
  "Shopping": "Shopping"
  "General": "Other"
  "Money added": "Income"
  "Charity": "Charity"
  "Entertainment": "Entertainment"

notes: |
  Wise exports:
  - CSV format with comma delimiter
  - DateTime format: YYYY-MM-DD HH:MM:SS
  - Direction field: IN/OUT (handled by normalizer for amount sign)
  - Status field: COMPLETED, CANCELLED, REFUNDED
  - Rich categorization
  - Exchange rate information included
  - Amounts are after fees
