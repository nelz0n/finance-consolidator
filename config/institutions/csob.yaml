# ČSOB Bank Configuration
# Handles CSV exports from ČSOB (csob_export_pohyby_*.csv)

institution:
  name: "ČSOB"
  type: "bank"
  country: "CZ"

file_detection:
  filename_patterns:
    - "csob_export_pohyby_*.csv"
    - "csob_*.csv"

csv_format:
  encoding: "utf-8-sig"  # BOM encoding
  delimiter: ";"
  has_header: true
  skip_rows: 2  # First row is title, second row is empty, third row is header

transformations:
  # Date format
  date:
    format: "%d.%m.%Y"  # 31.10.2025

  # Amount format
  amount:
    decimal_separator: ","
    thousands_separator: " "
    reverse_sign: false

  # Description cleanup
  description:
    strip_whitespace: true
    remove_patterns:
      - "^Částka: [\\d,.]+ CZK \\d{2}\\.\\d{2}\\.\\d{4} "
      - "Místo: "

  # Combine counterparty account + bank code
  combined_counterparty_account: "'číslo protiúčtu' + '/' + 'kód banky protiúčtu'"

column_mapping:
  # Core fields
  date: "datum zaúčtování"
  description: "zpráva"
  amount: "částka"
  currency: "měna"

  # Account info
  account: "číslo účtu"

  # Counterparty
  counterparty_account: "combined_counterparty_account"
  counterparty_name: "jméno protistrany"

  # Optional fields
  variable_symbol: "variabilní symbol"
  transaction_type: "označení operace"
  transaction_id: "ID transakce"
  category: "kategorie"

filtering:
  # Skip header row with account summary
  skip_if_contains:
    - "Pohyby na účtu"

owner_detection:
  method: "account_mapping"
  account_mapping:
    "283337817/0300": "Kreditka"
    "210621040/0300": "Brano"
    "243160770/0300": "Mirka"
  default_owner: "Unknown"

notes: |
  ČSOB exports:
  - BOM (Byte Order Mark) - handled by utf-8-sig encoding
  - Skip first 2 rows (account summary + empty line)
  - Semicolon delimiter
  - Comma decimal, space thousands separator
  - Rich transaction details
  - Pre-categorized transactions
