# Partners Bank Configuration
# Handles XLSX/CSV exports from Partners Bank

institution:
  name: "Partners Bank"
  type: "bank"
  country: "CZ"

file_detection:
  filename_patterns:
    - "vypis_*.csv"
    - "vypis_*.xlsx"

csv_format:
  encoding: "utf-8-sig"
  delimiter: ";"
  has_header: true
  skip_rows: 0

transformations:
  # Date format
  date:
    format: "%d. %m. %Y"  # 27. 10. 2025

  # Amount format
  amount:
    decimal_separator: ","
    thousands_separator: " "
    reverse_sign: false

  # Combine description fields
  combined_description: "'Název protistrany' + ' [Msg: ' + 'Zpráva pro příjemce' + '] [Note: ' + 'Poznámka pro mě' + ']'"

  # Combine counterparty account + bank code
  combined_counterparty_account: "'Číslo účtu protistrany' + '/' + 'Kód banky protistrany'"

column_mapping:
  # Core fields
  date: "Datum zúčtování"
  description: "combined_description"
  amount: "Částka"
  currency: "Měna"

  # Counterparty
  counterparty_account: "combined_counterparty_account"
  counterparty_name: "Název protistrany"

  # Optional fields
  variable_symbol: "Variabilní symbol"
  constant_symbol: "Konstantní symbol"
  specific_symbol: "Specifický symbol"
  transaction_type: "Typ úhrady"
  transaction_id: "Identifikace transakce"

  # Internal processing field
  _direction: "Směr úhrady"

  # Defaults - applied after column mapping
  defaults:
    account: "extract_from_filename"  # Extracts account from: vypis_1330299329_*.csv
    account_bank_code: "6363"  # Appends /6363 to extracted account

owner_detection:
  method: "account_mapping"
  account_mapping:
    "3581422554/6363": "Brano"
    "1330299329/6363": "Brano"
    "2106210400/6363": "Brano"
  default_owner: "Unknown"

notes: |
  Partners Bank exports:
  - Standard CSV/XLSX format with UTF-8 BOM encoding
  - Semicolon delimiter
  - Date format: "27. 10. 2025" (day. month. year with spaces)
  - Amount format: "14 000,00" (space thousands, comma decimal)
  - Direction field: "Příchozí" (incoming) / "Odchozí" (outgoing)
  - Account number extracted from filename: vypis_<account>_<from>_<to>.csv
  - Bank code /6363 auto-appended to account
  - Rich metadata: symbols, IBAN, transaction IDs
